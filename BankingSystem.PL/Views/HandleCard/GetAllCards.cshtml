
 @model IEnumerable<CardsViewModel>

@{
    ViewData["Title"] = "All Visa Cards";
}

<style>
    :root {
        --primary-dark: #0a2d2e;
        --primary-medium: #1c4e4f;
        --primary-light: #436e6f;
        --secondary-dark: #6a8e8f;
        --secondary-light: #879693;
        --neutral-1: #a49e97;
        --accent-1: #deae9f;
        --accent-2: #efd7cf;
        --accent-3: #f7ebe7;
        --white: #ffffff;
    }

    .card-grid {
        background: var(--accent-3);
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .visa-card {
        border: none;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s ease;
    }

        .visa-card:hover {
            transform: translateY(-5px);
        }

    .visa-card-header {
        background: linear-gradient(90deg, var(--primary-dark), var(--primary-medium));
        color: var(--white);
        padding: 1rem 1.5rem;
        font-weight: bold;
    }

    .visa-card-body {
        padding: 1.5rem;
    }

    .visa-card-footer {
        background: var(--accent-2);
        padding: 0.75rem;
        text-align: center;
    }

        .visa-card-footer .btn {
            font-weight: 500;
            margin-right: 10px;
        }

    /* Apply background color for the card according to type */
    .card-debit {
        background-color: #d1f2d1; /* Light green for Debit */
    }

    .card-credit {
        background-color: #f7d7d7; /* Light red for Credit */
    }
</style>
@section Scripts {
    <script>
        $(document).ready(function () {
            $('.delete-card-btn').click(function () {
                const button = $(this);
                const cardId = button.data('id');

                if (confirm('Are you sure you want to delete this card?')) {
                    $.ajax({
                        url: '/HandleCard/Delete', // make sure route matches controller
                        type: 'POST',
                        data: { id: cardId },
                        success: function (response) {
                            if (response.success) {
                                // Remove the card from the UI
                                button.closest('.col').fadeOut(300, function () {
                                    $(this).remove();
                                });
                            } else {
                                alert(response.message || 'Error deleting card.');
                            }
                        },
                        error: function () {
                            alert('Something went wrong. Please try again.');
                        }
                    });
                }
            });
        });
    </script>
}


<div class="container py-5">
    <h2 class="text-primary mb-4">
        <i class="fas fa-credit-card me-2"></i> All Visa Cards
    </h2>
    <div class="mb-3">
        <a asp-action="Create" class="btn btn-success">
            <i class="fas fa-plus me-1"></i> Create New Card
        </a>
    </div>

    @if (!Model.Any())
    {
        <div class="alert alert-info shadow-sm">
            <i class="fas fa-info-circle"></i> No cards available.
        </div>
    }
    else
    {
        <div class="card-grid">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                @foreach (var card in Model)
                {
                    <div class="col">
                        <div class="card visa-card h-100 @(card.CardType == "Debit" ? "card-debit" : "card-credit")">
                            <div class="visa-card-header d-flex justify-content-between">
                                <span>@card.CardType</span>
                                <span>•••• @card.Number.Substring(Math.Max(0, card.Number.Length - 4))</span>
                            </div>
                            <div class="visa-card-body">
                                <p><strong>Customer:</strong> @card.CustomerName</p>
                                <p><strong>Account Number:</strong> @card.AccountNumber</p>
                                <p><strong>CVV:</strong> @card.CVV</p>
                                <p><strong>Expiration:</strong> @card.ExpDate.ToString("MMMM yyyy")</p>
                                <p><strong>Created:</strong> @card.CreationDate.ToString("MMMM dd, yyyy")</p>
                            </div>
                            <div class="visa-card-footer">
                            
                                <button type="button" class="btn btn-outline-danger btn-sm delete-card-btn" data-id="@card.Id">
                                    <i class="fas fa-trash me-1"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
</div>
