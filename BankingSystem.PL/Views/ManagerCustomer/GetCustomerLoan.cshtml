@model List<BankingSystem.PL.ViewModels.Manager.LoanViewModel>

@{
    ViewData["Title"] = "Customer Loans";
    var customerId = ViewBag.CustomerId as string;
}

<!-- Add this line to include the custom CSS -->
<link rel="stylesheet" href="~/css/customer-details.css" />

<h2>Customer Loans</h2>

<div class="container">
    <div class="row">
        @foreach (var loan in Model)
        {
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h4>Loan Type: @loan.LoanType</h4>
                    </div>
                    <div class="card-body">
                        <p><strong>Account Number:</strong> @loan.AccountNumber</p>
                        <p><strong>Amount:</strong> @loan.LoanAmount</p>
                        <p><strong>Status:</strong> @loan.LoanStatus</p>
                        <p><strong>Start Date:</strong> @loan.StartDate.ToShortDateString()</p>
                        <p><strong>Current Debt:</strong> @loan.CurrentDebt</p>
                        <p><strong>Interest Rate:</strong> @loan.InterestRate</p>
                        <p><strong>Duration (Months):</strong> @loan.DurationInMonth</p>

                        <h5 class="loan-payments-title">Payments:</h5>
                        <div class="table-responsive">
                            <table class="table table-bordered table-sm loan-payments-table">
                                <thead>
                                    <tr>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Payment Date</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var payment in loan.Payments)
                                    {
                                        <tr>
                                            <td>@payment.Amount</td>
                                            <td>@payment.Status</td>
                                            <td>@payment.PaymentDate.ToShortDateString()</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>

    <a asp-controller="ManagerCustomer" asp-action="GetCustomerDetails" asp-route-id="@customerId" class="btn btn-secondary mt-3">
        Back
    </a>
</div>

                                    
<style> 
    /* Add these styles to your existing customer-details.css file */

    /* Loan payments section */
    .loan-payments-title {
        color: var(--primary-dark);
        margin-top: 1.5rem;
        margin-bottom: 1rem;
        font-weight: 600;
        border-bottom: 2px solid var(--primary-medium);
        padding-bottom: 0.5rem;
        display: inline-block;
    }

    /* Table styling */
    .loan-payments-table {
        width: 100%;
        margin-bottom: 1rem;
        border-collapse: separate;
        border-spacing: 0;
        border-radius: 6px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

        .loan-payments-table thead th {
            background-color: var(--primary-medium);
            color: var(--white);
            font-weight: 600;
            padding: 0.75rem;
            border: none;
            text-align: center;
        }

        .loan-payments-table tbody tr:nth-child(odd) {
            background-color: var(--primary-light);
        }

        .loan-payments-table tbody tr:nth-child(even) {
            background-color: var(--white);
        }

        .loan-payments-table tbody td {
            padding: 0.75rem;
            border: none;
            border-top: 1px solid var(--accent-2);
            vertical-align: middle;
        }

        .loan-payments-table tbody tr:hover {
            background-color: var(--accent-3);
        }

    /* Responsive table */
    .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        border-radius: 6px;
    }

    /* Card grid layout */
    .row {
        display: flex;
        flex-wrap: wrap;
        margin-right: -15px;
        margin-left: -15px;
    }

    /* Adjust card height for better alignment */
    .col-md-6.col-lg-4 .card {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

        .col-md-6.col-lg-4 .card .card-body {
            flex: 1;
        }

    .loan-payments-table {
        font-size: 0.9rem;
    }

    }
</style>
